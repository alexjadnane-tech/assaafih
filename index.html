<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Carnets</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    .grid {
      display: grid;
      grid-template-columns: repeat(10, 1fr);
      gap: 10px;
      margin-bottom: 20px;
    }
    .item {
      padding: 15px;
      text-align: center;
      border: 1px solid #ccc;
      border-radius: 6px;
      cursor: pointer;
      background: #f9f9f9;
    }
    .item.sold {
      background: #ddd;
      text-decoration: line-through;
      cursor: not-allowed;
    }
    #selected-box {
      margin-top: 20px;
      font-size: 18px;
    }
    #pay-btn {
      margin-top: 15px;
      padding: 10px 20px;
      font-size: 16px;
      display: none;
      background: black;
      color: white;
      border-radius: 4px;
      cursor: pointer;
    }
  </style>
</head>

<body>

<h2>Choisissez une édition</h2>

<div id="grid" class="grid"></div>

<div id="selected-box"></div>
<button id="pay-btn">Payer</button>

<script>
  // 1️⃣ Liste des liens Payrexx pour chaque édition
  const links = {
    1: "https://alexandreadnane.payrexx.com/fr/pay?pid=xxxx1",
    2: "https://alexandreadnane.payrexx.com/fr/pay?pid=xxxx2",
    3: "https://alexandreadnane.payrexx.com/fr/pay?pid=xxxx3",
    // → Tu mettras les 200 ici
  };

  let soldEditions = {};
  let selected = null;

  // 2️⃣ Charger sold.json
  async function loadSold() {
    const res = await fetch("sold.json?cache=" + Date.now());
    soldEditions = await res.json();
  }

  // 3️⃣ Affichage de la grille
  async function renderGrid() {
    await loadSold();

    const grid = document.getElementById("grid");
    grid.innerHTML = "";

    for (let i = 1; i <= 200; i++) {
      const div = document.createElement("div");
      div.className = "item";
      div.textContent = i;

      if (soldEditions[i]) {
        div.classList.add("sold");
      } else {
        div.onclick = () => selectEdition(i);
      }

      grid.appendChild(div);
    }
  }

  // 4️⃣ Sélection d’un carnet
  function selectEdition(num) {
    selected = num;
    document.getElementById("selected-box").textContent =
      "Selected edition : " + num;

    document.getElementById("pay-btn").style.display = "inline-block";
  }

  // 5️⃣ Bouton Payer
  document.getElementById("pay-btn").onclick = () => {
    if (!selected) return;
    const url = links[selected];
    if (!url) {
      alert("Aucun lien Payrexx pour cette édition !");
      return;
    }
    window.location.href = url;
  };

  renderGrid();
</script>

</body>
</html>
